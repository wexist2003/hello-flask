<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <title>Админка</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4">
    <h1>Панель администратора</h1>
    <form method="post" class="mb-4">
        <div class="input-group">
            <input type="text" name="name" class="form-control" placeholder="Введите имя пользователя" required>
            <button class="btn btn-primary" type="submit">Добавить</button>
        </div>
    </form>
    {% if message %}
        <div class="alert alert-info">{{ message }}</div>
    {% endif %}
    <h2>Список пользователей</h2>
<table class="table table-bordered">
    <thead>
        <tr>
            <th>Имя</th>
            <th>Ссылка</th>
            <th>Рейтинг</th>
            <th>Изображения</th>
        </tr>
    </thead>
    <tbody>
        {% for user in users %}
            <tr>
                <td>{{ user[1] }}</td>
                <td><a href="{{ url_for('user_page', user_code=user[2]) }}">Ссылка</a></td>
                <td>{{ user[3] }}</td>
                <td>
                    {% for image in user.images %}
                        <img src="{{ url_for('static', filename='images/' + image.subfolder + '/' + image.image) }}" width="50" height="50">
                    {% endfor %}
                </td>
            </tr>
        {% endfor %}
    </tbody>
</table>

            {% for user in users %}
                <tr>
                    <td>{{ user[1] }}</td>  <!-- Имя -->
                    <td><a href="{{ url_for('user', code=user[2]) }}" target="_blank">{{ url_for('user', code=user[2], _external=True) }}</a></td>  <!-- Ссылка -->
                    <td>{{ user[3] }}</td>  <!-- Рейтинг -->
                    <td>
                        <form action="{{ url_for('delete_user', user_id=user[0]) }}" method="post">
                            <button class="btn btn-danger" type="submit">Удалить</button>
                        </form>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
    <h2>Список изображений</h2>
<table class="table table-bordered">
    <thead>
        <tr>
            <th>Подкаталог</th>
            <th>Изображение</th>
            <th>Статус</th>
        </tr>
    </thead>
    <tbody>
        {% for image in images %}
            <tr>
                <td>{{ image[1] }}</td>  <!-- Подкаталог -->
                <td>{{ image[2] }}</td>  <!-- Имя изображения -->
                <td>{{ image[3] }}</td>  <!-- Статус -->
            </tr>
        {% endfor %}
    </tbody>
</table>
<h2>Настройки для изображений</h2>
<form method="POST" action="{{ url_for('set_images_status') }}">
    <label for="group">Выберите группу:</label>
    <select name="group" id="group" class="form-select">
        <option value="koloda1">Koloda 1</option>
        <option value="koloda2">Koloda 2</option>
    </select>
    
    <label for="image_count">Количество изображений для пользователя:</label>
    <input type="number" id="image_count" name="image_count" min="1" max="10" class="form-control" required>

    <button type="submit" class="btn btn-primary">Установить</button>
</form>

<a href="{{ url_for('admin_images') }}" class="btn btn-info">Просмотр изображений</a>

</body>
</html>
