<!doctype html>
<html lang="ru" data-bs-theme="light">

{# === Макроси === #}
{% macro render_table_card(table_image, g, leader_for_display, all_users, code, get_user_name_func) %}
    {# ... ваш макрос ... #}
{% endmacro %}

{% macro render_my_card(card_item, g, on_table, code, get_leading_user_id_func) %}
    {# ... ваш макрос ... #}
{% endmacro %}

{% macro render_game_board_cell(cell_data, get_user_name_func) %}
    {# ... ваш макрос ... #}
{% endmacro %}
{# === Кінець Макросів === #}

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Профиль {{ name }}</title> 
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <style>
        /* Ваши стили CSS без изменений */
        /* ... */
        h2 { 
            /* ... */ 
            font-size: 1.5rem; 
            /* ... */ 
        }
        /* ... */
         @media (max-width: 576px) { /* Мобільні */
            /* ... */
            h2 { font-size: 1.15rem; /* ... */ }
            /* ... */
         }
        /* ... */
    </style>
</head>

<body class="p-4">
    <div class="container-fluid">
        <button id="theme-toggle-btn" class="btn btn-outline-secondary btn-sm theme-toggle-button" title="Сменить тему">
            <i class="bi bi-circle-half"></i>
            <span id="theme-toggle-text" class="visually-hidden">Сменить тему</span>
        </button>

        <h1>Привет, {{ name }}!</h1> 
        <p class="fs-4">Ваш рейтинг: <strong>{{ rating }}</strong></p> 

        <div class="d-flex flex-column flex-sm-row justify-content-sm-between align-items-start align-items-sm-baseline mb-2">
            <span class="text-muted mb-1 mb-sm-0 fs-4"> 
                {% if leader_for_display %}
                    {% set displayed_leader_name = get_user_name(leader_for_display) %}
                    <i class="bi bi-star-fill text-success"></i>
                    Ведущий: <strong>{{ displayed_leader_name or ('ID ' + leader_for_display|string) }}</strong>
                {% else %}
                    Ведущий еще не определен.
                {% endif %}
            </span>
            <span class="text-muted fs-4"> 
                {% set next_leader_id = get_leading_user_id() %}
                {# Логика показа следующего ведущего #}
                {% if next_leader_id and next_leader_id != leader_for_display %}
                    {% set next_leader_name = get_user_name(next_leader_id) %}
                     Следующий ведущий: <strong>{{ next_leader_name or ('ID ' + next_leader_id|string) }}</strong>
                {% elif next_leader_id and next_leader_id == leader_for_display and g.show_card_info %}
                    {% set next_leader_name = get_user_name(next_leader_id) %}
                     Следующий ведущий: <strong>{{ next_leader_name or ('ID ' + next_leader_id|string) }}</strong>
                 {% endif %}
            </span>
        </div>

        {# ... Остальная часть вашего шаблона user.html ... #}

    </div>

    {# ... Остальная часть вашего шаблона user.html (overlay, скрипты) ... #}
</body>
</html>
