<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Страница игрока - {{ user_data_for_init.name if user_data_for_init else 'Игрок' }}</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        /* Примерные стили, можете их доработать или вынести в style.css */
        .game-board {
            display: flex;
            flex-wrap: wrap;
            justify-content: center; /* или space-around */
            align-items: flex-start; /* Выравнивание по верху, если ячейки разной высоты из-за контента */
            gap: 4px; /* Пространство между ячейками, если flexBasis не учитывает margin */
        }
        
        .game-board-cell {
            /* border: 1px solid #ccc; уже есть */
            /* padding: 5px; уже есть */
            /* margin: 2px; уже есть (управляется gap или calc в flexBasis) */
            min-height: 100px; /* или фиксированная высота, как в JS */
            background-size: cover;
            background-position: center;
            position: relative;
            display: flex;
            flex-direction: column; /* Чтобы номер и фишки были друг под другом */
            justify-content: space-between; /* Номер сверху, фишки снизу */
            align-items: center; /* Центрирование фишек, если их несколько */
            box-sizing: border-box;
        }
        
        .cell-number-badge {
            position: absolute;
            top: 2px;
            left: 2px;
            font-size: 0.7em;
            opacity: 0.8;
        }
        
        .player-chips-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            width: 100%; /* Чтобы занимал всю ширину ячейки для центрирования */
        }
        
        .player-chip {
            /* display: inline-block; уже есть */
            /* background-color: rgba(0,0,255,0.7); уже есть (теперь через badge-primary/success) */
            /* color: white; уже есть */
            padding: 2px 4px; /* Немного уменьшил padding */
            border-radius: .25rem; /* Bootstrap стиль для badge */
            margin: 1px;
            font-size: 0.75em; /* Немного увеличил шрифт */
            line-height: 1; /* Для лучшего вида badge */
        }
        
        .user-hand .card, .table-cards .card {
            margin-bottom: 15px; /* Немного увеличил отступ */
            height: 100%; /* Для выравнивания карт в ряду по высоте, если используется .h-100 */
        }
        .card-img-top {
            max-height: 150px; /* Ограничение высоты изображения карты */
            object-fit: contain; /* Чтобы изображение полностью помещалось без обрезки */
            margin-top: 5px;
        }
        .card-body {
            padding: 0.5rem; /* Уменьшил внутренние отступы у тела карты */
            font-size: 0.9rem;
        }
        .card-body .form-group {
            margin-bottom: 0.5rem; /* Уменьшил отступ у группы формы */
        }
        .card-body .btn {
            font-size: 0.8rem; /* Уменьшил шрифт кнопок */
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <h1 id="user-greeting">Добро пожаловать, {{ user_data_for_init.name if user_data_for_init else 'Игрок' }}!</h1>
        <p>Ваш код: <code id="user-code-display">{{ user_data_for_init.code if user_data_for_init else 'Не определен' }}</code></p>
        <p>Ваш рейтинг: <strong id="user-rating-display">{{ user_data_for_init.rating if user_data_for_init else 0 }}</strong></p>
        <p id="user-status-display">Статус: {{ user_data_for_init.status if user_data_for_init else 'Не определен' }}</p>

        <hr>

        <div id="game-messages" class="alert alert-info" role="alert" style="display: none;"></div>

        <div id="game-status-info">
            <p>Статус игры: <strong id="game-progress-status">Загрузка...</strong></p>
            <p>Текущая колода: <strong id="current-deck-display">Загрузка...</strong></p>
            <p>Ведущий: <strong id="current-leader-display">Загрузка...</strong></p>
            <p id="pending-player-message" class="pending-message" style="display: none;">
                Вы присоединились как наблюдатель. Ваше участие начнется со следующей НОВОЙ игры. Пока вы можете следить за процессом.
            </p>
        </div>
        <hr>

        <div id="player-hand-section" style="display: none;">
            <h2>Ваши карты:</h2>
            <div id="player-hand" class="row user-hand">
                </div>
        </div>

        <h2>Карты на столе (<span id="cards-on-table-count">0</span>/<span id="active-players-count">0</span>):</h2>
        <div id="table-cards" class="row table-cards">
            </div>
        <div id="table-placeholder" class="text-center" style="display: none;">
            <img id="leader-empty-table-pictogram" src="" alt="Место ведущего" style="max-width: 100px; display: none;">
            <p id="leader-empty-table-rating" style="display: none;"></p>
            <p>На столе пока нет карт. Если вы ведущий, выберите карту для выкладывания.</p>
        </div>
        <hr>

        <h2>Игровое поле:</h2>
        <div id="game-board" class="d-flex flex-wrap justify-content-center">
            </div>
        <hr>

        <p><a href="{{ url_for('index') }}" class="btn btn-secondary">Вернуться на главную</a></p>
        {% if session.get('is_admin') %}
            <p><a href="{{ url_for('admin') }}" class="btn btn-info">Перейти в Админ панель</a></p>
        {% endif %}
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>

    <script>
        const currentUserCode = "{{ user_data_for_init.code if user_data_for_init else '' }}";
        let currentUserId = parseInt("{{ user_data_for_init.id if user_data_for_init else 0 }}") || null;
        let currentUserName = "{{ user_data_for_init.name if user_data_for_init else 'Игрок' }}";

        const socket = io();

        socket.on('connect', () => {
            console.log('Socket.IO: Connected to server! SID:', socket.id);
            // Если initial_state не придет сразу, можно запросить его
            // socket.emit('request_initial_state', { code: currentUserCode });
        });

        socket.on('disconnect', () => {
            console.log('Socket.IO: Disconnected from server.');
            const gameMessagesDiv = document.getElementById('game-messages');
            if (gameMessagesDiv) {
                gameMessagesDiv.textContent = 'Соединение с сервером потеряно. Попытка переподключения...';
                gameMessagesDiv.className = 'alert alert-danger mt-2';
                gameMessagesDiv.style.display = 'block';
            }
        });

        socket.on('message', (data) => {
            console.log('Socket.IO: Message from server:', data);
            const gameMessagesDiv = document.getElementById('game-messages');
            if (gameMessagesDiv && data.data) {
                 gameMessagesDiv.textContent = data.data;
                 gameMessagesDiv.className = data.category ? `alert alert-${data.category} mt-2` : 'alert alert-info mt-2';
                 gameMessagesDiv.style.display = 'block';
                 setTimeout(() => { gameMessagesDiv.style.display = 'none'; }, 5000); // Скрывать сообщение через 5 секунд
            }
        });

        socket.on('game_update', (gameState) => {
            console.log('Socket.IO: Received game_update:', gameState);

            if (gameState.current_user_data) {
                currentUserId = gameState.current_user_data.id;
                currentUserName = gameState.current_user_data.name;
                document.getElementById('user-greeting').textContent = `Добро пожаловать, ${currentUserName}!`;
                document.getElementById('user-code-display').textContent = gameState.current_user_data.code;
                document.getElementById('user-rating-display').textContent = gameState.current_user_data.rating;
                document.getElementById('user-status-display').textContent = `Статус: ${gameState.current_user_data.status}`;

                const pendingPlayerMessage = document.getElementById('pending-player-message');
                if (gameState.current_user_data.status === 'pending') {
                    pendingPlayerMessage.style.display = 'block';
                    document.getElementById('player-hand-section').style.display = 'none';
                } else {
                    pendingPlayerMessage.style.display = 'none';
                    document.getElementById('player-hand-section').style.display = 'block';
                }
            }

            updateGameStatusInfo(gameState);
            updatePlayerHand(gameState);
            updateTableCards(gameState);
            updateGameBoard(gameState.game_board || [], gameState.current_num_board_cells);

            const gameMessagesDiv = document.getElementById('game-messages');
            if (gameState.flashed_messages && gameState.flashed_messages.length > 0) {
                const firstMessage = gameState.flashed_messages[0];
                gameMessagesDiv.textContent = firstMessage.message;
                gameMessagesDiv.className = `alert alert-${firstMessage.category} mt-2`;
                gameMessagesDiv.style.display = 'block';
                setTimeout(() => { gameMessagesDiv.style.display = 'none'; }, 7000); // Скрывать сообщение через 7 секунд
            } else if (gameMessagesDiv && gameMessagesDiv.textContent === 'Соединение с сервером потеряно. Попытка переподключения...') {
                 gameMessagesDiv.style.display = 'none'; // Скрыть сообщение о потере соединения, если пришло обновление
            }
        });

        // --------------- Функции для рендеринга ---------------

        function updateGameStatusInfo(gameState) {
            let statusText = 'Загрузка...';
            if (gameState.game_over) {
                statusText = 'Игра окончена!';
            } else if (gameState.game_in_progress) {
                statusText = 'Идет игра';
            } else {
                statusText = 'Игра не начата / Ожидание игроков';
            }
            document.getElementById('game-progress-status').textContent = statusText;
            document.getElementById('current-deck-display').textContent = gameState.active_subfolder || 'Не выбрана';

            let leaderName = 'Не определен';
            let isCurrentUserLeader = false;
            if (gameState.db_current_leader_id && gameState.current_user_data) {
                 isCurrentUserLeader = (gameState.db_current_leader_id === gameState.current_user_data.id);
                 // Ищем имя ведущего (сначала в all_users_for_guessing, потом в current_user_data)
                 const leaderInGuessingList = gameState.all_users_for_guessing.find(u => u.id === gameState.db_current_leader_id);
                 if (leaderInGuessingList) {
                     leaderName = leaderInGuessingList.name;
                 } else if (isCurrentUserLeader) {
                     leaderName = gameState.current_user_data.name;
                 } else {
                     // Попытка найти имя ведущего в данных с игрового поля, если его нет в других списках
                     // Это может быть полезно, если all_users_for_guessing не содержит ведущего (что маловероятно)
                     if (gameState.game_board) {
                        for (const cell of gameState.game_board) {
                            const userInCell = cell.users_in_cell.find(u => u.id === gameState.db_current_leader_id);
                            if (userInCell) {
                                leaderName = userInCell.name;
                                break;
                            }
                        }
                     }
                 }
            }
            document.getElementById('current-leader-display').textContent = leaderName + (isCurrentUserLeader && gameState.game_in_progress ? ' (Это вы!)' : '');
            document.getElementById('active-players-count').textContent = gameState.num_active_players || 0;
            document.getElementById('cards-on-table-count').textContent = gameState.num_cards_on_table || 0;
        }

        function updatePlayerHand(gameState) {
            const { user_cards, active_subfolder, current_user_data, game_in_progress, game_over, on_table_status, show_card_info, all_cards_placed_for_guessing_phase_to_template, db_current_leader_id } = gameState;
            const playerHandDiv = document.getElementById('player-hand');
            const playerHandSectionDiv = document.getElementById('player-hand-section');
            playerHandDiv.innerHTML = '';

            if (!current_user_data || current_user_data.status === 'pending') {
                playerHandSectionDiv.style.display = 'none';
                return;
            }
            playerHandSectionDiv.style.display = 'block';

            if (!user_cards || user_cards.length === 0) {
                if (game_in_progress && !game_over) {
                    playerHandDiv.innerHTML = '<div class="col-12"><p>У вас нет карт на руках для этой колоды.</p></div>';
                } else if (game_over) {
                     playerHandDiv.innerHTML = '<div class="col-12"><p>Игра окончена.</p></div>';
                } else {
                     playerHandDiv.innerHTML = '<div class="col-12"><p>Ожидание начала игры или раздачи карт.</p></div>';
                }
                return;
            }

            const isLeader = current_user_data.id === db_current_leader_id;
            // Условия, когда можно выложить карту:
            // 1. Игра идет.
            // 2. Игра не окончена.
            // 3. Карты еще не открыты (show_card_info === false).
            // 4. Карты не выложены всеми для этапа угадывания (all_cards_placed_for_guessing_phase_to_template === false).
            // 5. Текущий пользователь - ведущий И у него еще нет карты на столе (isLeader && !on_table_status)
            // ИЛИ Текущий пользователь - НЕ ведущий И у него еще нет карты на столе (!isLeader && !on_table_status)
            //    То есть, любой активный игрок может выложить одну карту, если еще не сделал этого и не все выложили.
            const canPlaceCard = game_in_progress && !game_over && !show_card_info && !all_cards_placed_for_guessing_phase_to_template && !on_table_status;

            user_cards.forEach(card => {
                const cardDiv = document.createElement('div');
                cardDiv.className = 'col-md-3 col-sm-4 col-6 mb-3';
                let buttonHtml = '';
                if (canPlaceCard) {
                    buttonHtml = `
                        <form action="/user/${current_user_data.code}/place/${card.id}" method="POST" class="place-card-form">
                            <button type="submit" class="btn btn-primary btn-sm btn-block">Выложить на стол</button>
                        </form>`;
                } else if (on_table_status) {
                     buttonHtml = '<p class="text-muted small text-center">(Ваша карта уже на столе)</p>';
                } else if (all_cards_placed_for_guessing_phase_to_template) {
                     buttonHtml = '<p class="text-muted small text-center">(Все выложили карты)</p>';
                } else if (show_card_info) {
                     buttonHtml = '<p class="text-muted small text-center">(Карты уже открыты)</p>';
                }


                cardDiv.innerHTML = `
                    <div class="card h-100">
                        <img src="/static/images/${card.subfolder}/${card.image}" class="card-img-top" alt="Карта ${card.image}">
                        <div class="card-body text-center d-flex flex-column justify-content-end">
                            ${buttonHtml}
                        </div>
                    </div>
                `;
                playerHandDiv.appendChild(cardDiv);
            });
        }

        function updateTableCards(gameState) {
            const { table_images, all_users_for_guessing, show_card_info, all_cards_placed_for_guessing_phase_to_template, db_current_leader_id, current_user_data, game_in_progress, leader_pole_pictogram_path, leader_pictogram_rating_display } = gameState;
            const tableCardsDiv = document.getElementById('table-cards');
            const tablePlaceholderDiv = document.getElementById('table-placeholder');
            const leaderPictogramImg = document.getElementById('leader-empty-table-pictogram');
            const leaderPictogramRatingP = document.getElementById('leader-empty-table-rating');

            tableCardsDiv.innerHTML = ''; // Очищаем предыдущие карты

            if (!game_in_progress && !show_card_info) {
                tablePlaceholderDiv.style.display = 'block';
                tableCardsDiv.style.display = 'none';
                if(leaderPictogramImg) leaderPictogramImg.style.display = 'none';
                if(leaderPictogramRatingP) leaderPictogramRatingP.style.display = 'none';
                tablePlaceholderDiv.querySelector('p').textContent = 'Игра еще не началась или уже завершена.';
                return;
            }

            if (!table_images || table_images.length === 0) {
                tablePlaceholderDiv.style.display = 'block';
                tableCardsDiv.style.display = 'none';
                if (game_in_progress && leader_pole_pictogram_path && current_user_data && current_user_data.id === db_current_leader_id && !gameState.on_table_status) {
                    if(leaderPictogramImg) {
                        leaderPictogramImg.src = `/static/${leader_pole_pictogram_path}`;
                        leaderPictogramImg.style.display = 'block';
                    }
                    if(leaderPictogramRatingP) {
                        leaderPictogramRatingP.textContent = `Ваше место (рейтинг ${leader_pictogram_rating_display || 0}). Выложите карту.`;
                        leaderPictogramRatingP.style.display = 'block';
                    }
                    tablePlaceholderDiv.querySelector('p').textContent = '';
                } else {
                    if(leaderPictogramImg) leaderPictogramImg.style.display = 'none';
                    if(leaderPictogramRatingP) leaderPictogramRatingP.style.display = 'none';
                    tablePlaceholderDiv.querySelector('p').textContent = 'На столе пока нет карт. Ожидание игроков...';
                }
                return;
            }

            tablePlaceholderDiv.style.display = 'none';
            tableCardsDiv.style.display = 'flex'; 

            table_images.forEach(card => {
                const cardDiv = document.createElement('div');
                cardDiv.className = 'col-md-3 col-sm-4 col-6 mb-3';
                let cardImageSrc = "";
                let cardAltText = "Карта на столе";
                let cardBodyContent = '';

                if (!all_cards_placed_for_guessing_phase_to_template && !show_card_info) {
                    // ЭТАП 1: Игроки еще выкладывают карты. Показываем "рубашку" (вашу заглушку).
                    cardImageSrc = "/static/images/a.jpg"; // <--- ИЗМЕНЕНО НА ВАШ ПУТЬ
                    cardAltText = "Карта на столе (заглушка)";
                    cardBodyContent = '<p class="card-text text-muted small text-center">(Карта выложена)</p>';
                } else {
                    cardImageSrc = `/static/images/${card.subfolder}/${card.image}`;
                    cardAltText = `Карта ${card.image}`;
                }

                if (show_card_info) { 
                    cardBodyContent = `<h6 class="card-subtitle mb-2 text-muted">Владелец: ${card.owner_name || 'Неизвестен'}</h6>`;
                    if (card.guesses && Object.keys(card.guesses).length > 0) {
                        cardBodyContent += '<p class="card-text small"><u>Предположения:</u></p><ul class="list-unstyled small">';
                        for (const guesserIdStr in card.guesses) {
                            const guessedTargetId = card.guesses[guesserIdStr];
                            let guesserName = `Игрок ID ${guesserIdStr}`;
                            const guesserUser = all_users_for_guessing.find(u => u.id === parseInt(guesserIdStr)) || (current_user_data && current_user_data.id === parseInt(guesserIdStr) ? current_user_data : null);
                            if (guesserUser) guesserName = guesserUser.name;

                            let targetName = `Игрок ID ${guessedTargetId}`;
                            const targetUserInGuessList = all_users_for_guessing.find(u => u.id === guessedTargetId);
                            const targetUserIsCurrentUser = current_user_data && current_user_data.id === guessedTargetId;
                            const targetUserIsOwner = card.owner_id === guessedTargetId;

                            if (targetUserInGuessList) targetName = targetUserInGuessList.name;
                            else if (targetUserIsCurrentUser) targetName = current_user_data.name;
                            else if (targetUserIsOwner) targetName = card.owner_name;

                            const isCorrect = guessedTargetId === card.owner_id;
                            cardBodyContent += `<li>${guesserName} -> ${targetName} <span class="badge badge-${isCorrect ? 'success' : 'danger'}">${isCorrect ? 'Верно' : 'Мимо'}</span></li>`;
                        }
                        cardBodyContent += '</ul>';
                    } else {
                        cardBodyContent += '<p class="card-text small">Предположений не было.</p>';
                    }
                } else if (all_cards_placed_for_guessing_phase_to_template && current_user_data && current_user_data.status === 'active') { 
                    if (card.owner_id !== current_user_data.id) { 
                        let selectOptions = '<option value="">-- Выберите игрока --</option>';
                        all_users_for_guessing.forEach(user => {
                            if (user.id !== current_user_data.id) {
                                selectOptions += `<option value="${user.id}" ${card.my_guess_for_this_card_value == user.id ? 'selected' : ''}>${user.name}</option>`;
                            }
                        });
                        if (card.owner_id && card.owner_id !== current_user_data.id && !all_users_for_guessing.find(u=>u.id === card.owner_id)) {
                             selectOptions += `<option value="${card.owner_id}" ${card.my_guess_for_this_card_value == card.owner_id ? 'selected' : ''}>${card.owner_name || `Игрок ID ${card.owner_id}`}</option>`;
                        }

                        cardBodyContent = `
                            <form action="/user/${current_user_data.code}/guess/${card.id}" method="POST" class="guess-card-form">
                                <div class="form-group">
                                    <label for="guess-for-${card.id}" class="small">Чья это карта?</label>
                                    <select name="guessed_user_id" id="guess-for-${card.id}" class="form-control form-control-sm">
                                        ${selectOptions}
                                    </select>
                                </div>
                                <button type="submit" class="btn btn-warning btn-sm btn-block">${card.my_guess_for_this_card_value ? 'Изменить голос' : 'Угадать'}</button>
                            </form>`;
                        if(card.my_guess_for_this_card_value) {
                            let guessedName = `ID ${card.my_guess_for_this_card_value}`;
                            const guessedUserObj = all_users_for_guessing.find(u => u.id == card.my_guess_for_this_card_value) ||
                                                 (card.owner_id == card.my_guess_for_this_card_value ? { name: card.owner_name } : null) ||
                                                 (current_user_data && current_user_data.id == card.my_guess_for_this_card_value ? current_user_data : null) ;
                            if(guessedUserObj) guessedName = guessedUserObj.name;
                            cardBodyContent += `<p class="mt-1 mb-0 small text-success">Ваш выбор: ${guessedName}</p>`;
                        }
                    } else { 
                        cardBodyContent += '<p class="card-text text-muted small text-center">(Это ваша карта)</p>';
                    }
                } else if (current_user_data && current_user_data.status === 'active' && !all_cards_placed_for_guessing_phase_to_template) {
                    // Этап выкладывания - cardImageSrc уже '/static/images/a.jpg', cardBodyContent уже '(Карта выложена)'
                    // Ничего дополнительно не делаем для cardBodyContent здесь, он уже установлен выше
                } else if (!current_user_data || current_user_data.status !== 'active') { 
                     cardBodyContent = '<p class="card-text text-muted small text-center">(Вы наблюдатель)</p>';
                }


                cardDiv.innerHTML = `
                    <div class="card h-100">
                        <img src="${cardImageSrc}" class="card-img-top" alt="${cardAltText}">
                        <div class="card-body d-flex flex-column justify-content-center">
                            ${cardBodyContent}
                        </div>
                    </div>
                `;
                tableCardsDiv.appendChild(cardDiv);
            });
        }

        function updateGameBoard(boardCells, totalCells) {
            const gameBoardDiv = document.getElementById('game-board');
            gameBoardDiv.innerHTML = '';

            if (!boardCells || boardCells.length === 0) {
                gameBoardDiv.innerHTML = '<p class="text-muted">Игровое поле не загружено или не сконфигурировано.</p>';
                return;
            }

            const cellsInRow = Math.min(totalCells > 10 ? Math.ceil(Math.sqrt(totalCells * 1.5)) : 10, 12); // Адаптивное количество ячеек в ряду
            const cellWidthPercent = 100 / cellsInRow;

            boardCells.forEach(cell => {
                const cellDiv = document.createElement('div');
                cellDiv.className = 'game-board-cell text-white p-1 shadow-sm'; // Добавлены классы для стилизации
                cellDiv.style.backgroundImage = `url(/static/${cell.image_path})`;
                // cellDiv.style.width = `calc(${cellWidthPercent}% - 4px)`;
                cellDiv.style.flexBasis = `calc(${cellWidthPercent}% - 4px)`; // для flex-контейнера
                cellDiv.style.height = '100px'; // Фиксированная высота для единообразия
                cellDiv.title = `Ячейка ${cell.cell_number}`;

                let cellHtml = `<div class="cell-number-badge badge badge-dark">${cell.cell_number}</div>`;
                if (cell.users_in_cell && cell.users_in_cell.length > 0) {
                    cellHtml += '<div class="player-chips-container mt-1">';
                    cell.users_in_cell.forEach(user => {
                        // Выделяем текущего пользователя на поле
                        const isCurrentUserOnCell = currentUserId && user.id === currentUserId;
                        cellHtml += `<span class="player-chip badge ${isCurrentUserOnCell ? 'badge-success' : 'badge-primary'}" title="${user.name} (Рейтинг: ${user.rating})">${user.name.substring(0,3)}</span>`;
                    });
                    cellHtml += '</div>';
                }
                cellDiv.innerHTML = cellHtml;
                gameBoardDiv.appendChild(cellDiv);
            });
        }
    </script>
</body>
</html>
